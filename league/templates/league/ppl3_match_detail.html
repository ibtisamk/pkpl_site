{% extends "league/base.html" %}
{% load static %}
{% block content %}

<!-- PREMIUM PPL3 BACKGROUND -->
<div class="min-h-screen bg-gradient-to-b from-[#0b2f2f] via-[#0f3d4c] to-[#0b2f2f] text-white px-4 py-10">

  <div class="max-w-5xl mx-auto space-y-12">

    <!-- HEADER -->
    <div class="text-center space-y-2">
      <h1 class="text-4xl font-extrabold tracking-wide text-yellow-300 drop-shadow-lg">
        Match Details
      </h1>
      <p class="text-blue-200/80 text-sm">
        {{ match.fixture.season.name }} — {{ match.fixture.date|date:"M d, Y" }}
      </p>
    </div>

    <!-- SCOREBOARD -->
    <div class="bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-xl shadow-xl text-center space-y-4">

      <div class="text-2xl font-bold">
        <span class="text-blue-200">{{ match.fixture.home_club.name }}</span>
        <span class="text-yellow-300 mx-4">{{ match.home_goals }} - {{ match.away_goals }}</span>
        <span class="text-blue-200">{{ match.fixture.away_club.name }}</span>
      </div>

      <p class="text-blue-200/70 text-sm">
        Played on {{ match.fixture.date|date:"F d, Y" }}
      </p>

      {% for s in stats %}
        {% if s.man_of_the_match %}
          <div class="mt-3 pt-3 border-t border-white/20">
            <p class="text-yellow-300 font-semibold text-sm">
              ⭐ Man of the Match: <a href="{% url 'ppl3_player' s.player.id %}" class="hover:underline">{{ s.player.gamertag }}</a>
            </p>
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <!-- LINEUPS -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

      <!-- HOME LINEUP -->
      <div class="bg-white/5 border border-white/10 rounded-2xl p-5 backdrop-blur-xl shadow-xl">
        <h2 class="text-xl font-bold text-yellow-300 mb-3">
          {{ match.fixture.home_club.name }} — Lineup
        </h2>

        <ul class="space-y-2">
          {% for p in match.home_players.all %}
          <li class="text-blue-200">{{ p.gamertag }}</li>
          {% empty %}
          <li class="text-blue-200/70">No lineup submitted.</li>
          {% endfor %}
        </ul>
      </div>

      <!-- AWAY LINEUP -->
      <div class="bg-white/5 border border-white/10 rounded-2xl p-5 backdrop-blur-xl shadow-xl">
        <h2 class="text-xl font-bold text-yellow-300 mb-3">
          {{ match.fixture.away_club.name }} — Lineup
        </h2>

        <ul class="space-y-2">
          {% for p in match.away_players.all %}
          <li class="text-blue-200">{{ p.gamertag }}</li>
          {% empty %}
          <li class="text-blue-200/70">No lineup submitted.</li>
          {% endfor %}
        </ul>
      </div>

    </div>

    <!-- PLAYER STATS TABLES -->
    <section class="grid grid-cols-1 md:grid-cols-2 gap-6">
      
      <!-- HOME TEAM STATS -->
      <div>
        <h2 class="text-xl font-bold text-yellow-300 mb-3">{{ match.fixture.home_club.name }} — Stats</h2>
        <div class="overflow-x-auto">
          <table class="w-full text-left border-collapse bg-white/5 border border-white/10 rounded-2xl backdrop-blur-xl shadow-xl">
            <thead class="bg-white/10 text-blue-200 uppercase text-xs tracking-wider">
              <tr>
                <th class="px-3 py-2">Player</th>
                <th class="px-2 py-2 text-center">G</th>
                <th class="px-2 py-2 text-center">A</th>
                <th class="px-2 py-2 text-center">R</th>
              </tr>
            </thead>
            <tbody class="text-sm">
              {% for s in stats %}
                {% if s.player in match.home_players.all %}
                <tr class="border-t border-white/10 hover:bg-white/10 transition {% if s.man_of_the_match %}bg-yellow-500/10{% endif %}">
                  <td class="px-3 py-2 font-semibold text-blue-200">
                    <a href="{% url 'ppl3_player' s.player.id %}" class="hover:text-yellow-300 transition">
                      {{ s.player.gamertag }}
                    </a>
                    {% if s.man_of_the_match %}<span class="text-yellow-300 ml-1">⭐</span>{% endif %}
                  </td>
                  <td class="px-2 py-2 text-center">{{ s.goals }}</td>
                  <td class="px-2 py-2 text-center">{{ s.assists }}</td>
                  <td class="px-2 py-2 text-center text-yellow-300 font-bold">{{ s.rating }}</td>
                </tr>
                {% endif %}
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <!-- AWAY TEAM STATS -->
      <div>
        <h2 class="text-xl font-bold text-yellow-300 mb-3">{{ match.fixture.away_club.name }} — Stats</h2>
        <div class="overflow-x-auto">
          <table class="w-full text-left border-collapse bg-white/5 border border-white/10 rounded-2xl backdrop-blur-xl shadow-xl">
            <thead class="bg-white/10 text-blue-200 uppercase text-xs tracking-wider">
              <tr>
                <th class="px-3 py-2">Player</th>
                <th class="px-2 py-2 text-center">G</th>
                <th class="px-2 py-2 text-center">A</th>
                <th class="px-2 py-2 text-center">R</th>
              </tr>
            </thead>
            <tbody class="text-sm">
              {% for s in stats %}
                {% if s.player in match.away_players.all %}
                <tr class="border-t border-white/10 hover:bg-white/10 transition {% if s.man_of_the_match %}bg-yellow-500/10{% endif %}">
                  <td class="px-3 py-2 font-semibold text-blue-200">
                    <a href="{% url 'ppl3_player' s.player.id %}" class="hover:text-yellow-300 transition">
                      {{ s.player.gamertag }}
                    </a>
                    {% if s.man_of_the_match %}<span class="text-yellow-300 ml-1">⭐</span>{% endif %}
                  </td>
                  <td class="px-2 py-2 text-center">{{ s.goals }}</td>
                  <td class="px-2 py-2 text-center">{{ s.assists }}</td>
                  <td class="px-2 py-2 text-center text-yellow-300 font-bold">{{ s.rating }}</td>
                </tr>
                {% endif %}
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

    </section>

  </div>
</div>

{% endblock %}
