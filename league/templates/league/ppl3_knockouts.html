{% extends "league/base.html" %}
{% load static %}
{% block content %}

<!-- PREMIUM PPL3 BACKGROUND -->
<div class="min-h-screen bg-gradient-to-b from-[#0b2f2f] via-[#0f3d4c] to-[#0b2f2f] text-white px-4 py-10">

  <div class="max-w-6xl mx-auto space-y-14">

    <!-- HEADER -->
    <div class="text-center space-y-2">
      <h1 class="text-4xl font-extrabold tracking-wide text-yellow-300 drop-shadow-lg">
        PPL 3.0 â€” Knockout Bracket
      </h1>
      <p class="text-blue-200/80 text-sm">
        Quarterfinals, Semifinals, and Final
      </p>
    </div>

    <!-- BRACKET -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-10">

      {% for rnd in rounds %}
      <div class="space-y-4">
        <h2 class="text-xl font-bold text-blue-200">{{ rnd.round.get_round_type_display }}</h2>

        {% for m in rnd.matches %}
        <div class="block bg-white/5 border border-white/10 rounded-xl p-4 backdrop-blur-xl hover:bg-white/10 transition">

          {% if m.detail_url %}
          <a href="{{ m.detail_url }}" class="font-semibold text-lg block">{{ m.home }} vs {{ m.away }}</a>
          {% else %}
          <div class="font-semibold text-lg">{{ m.home }} vs {{ m.away }}</div>
          {% endif %}

          {% if m.played %}
            <div class="text-yellow-300 font-bold mt-2 text-lg">{{ m.score }}</div>

            {% comment %} display winner if match object has goals or km had goals {% endcomment %}
            {% if m.match and m.match.__class__.__name__ == 'Match' %}
              {% if m.match.home_goals > m.match.away_goals %}
                <div class="text-green-300 font-bold mt-1">Winner: {{ m.home }}</div>
              {% elif m.match.away_goals > m.match.home_goals %}
                <div class="text-green-300 font-bold mt-1">Winner: {{ m.away }}</div>
              {% endif %}
            {% else %}
              {% comment %} if fallback (km) has a score show winner based on score string split {% endcomment %}
              {% if m.score %}
                {% with parts=m.score.split '-' %}
                  {% if parts.0|int > parts.1|int %}
                    <div class="text-green-300 font-bold mt-1">Winner: {{ m.home }}</div>
                  {% elif parts.1|int > parts.0|int %}
                    <div class="text-green-300 font-bold mt-1">Winner: {{ m.away }}</div>
                  {% endif %}
                {% endwith %}
              {% endif %}
            {% endif %}
          {% endif %}

        </div>
        {% endfor %}

      </div>
      {% endfor %}

    </div>

  </div>
</div>

{% endblock %}
